<r:set_var name="featurettes_labels">
  <r:page:slug />,featurette
</r:set_var>

<div class="wvu-featurettes wvu-featurettes--1 <r:page:content name="wvu-background-color-class--featurettes-anywhere" /> background">
  <div class="wvu-featurettes__container">

    <!-- Check to see if page has a featurettes_id. If so, find page with that ID and its display children that are labeled 'feature'. -->

    <r:if expr="{{ NOT(BLANK(featurettes_id)) }}">
      <r:get_page id="{$featurettes_id}">
        <r:children labels="feature" labels_match="any" by="title" order="asc">
          <div class="wvu-featurettes__featurettes wvu-featurettes__featurettes--<r:count />">
            <r:each>
              <r:partial name="patterns/wvu-featurettes__featurette" />
            </r:each>
          </div>
        </r:children>
      </r:get_page>
    </r:if>
    
    <!-- If no featurettes_id, find any pages labeled with 'featurette' and the page slug -->

    <r:if expr="{{ BLANK(featurettes_id) }}">
      <r:root>
        <r:descendants labels="{$featurettes_labels}" labels_match="all" by="title" order="asc">
          <div class="wvu-featurettes__featurettes wvu-featurettes__featurettes--<r:count />">
            <r:each>
              <r:partial name="patterns/wvu-featurettes__featurette" />
            </r:each>
          </div>
        </r:descendants>
      </r:root>
    </r:if>

  </div>
</div>